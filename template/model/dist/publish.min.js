$(function(){function e(e,o){p.empty(),p.append($('<div id="legend-container"><h4 class="panel-title">'+Publish.legend+"</h4><br/></div>"));var n=$('<div id="legend-content">').appendTo($("#legend-container"));$.each(e,function(e,t){var i=$('<div style="height:25px;">').append($('<div class="legend-color-box">').css({backgroundColor:t})).append($("<span>").css("lineHeight","23px").html(o+" "+e));n.append(i)})}function o(e){return{fillColor:e.getProperty("color"),strokeWeight:1}}function n(n){var t=n.target.id,i=r[t];if(i)if(i.getMap())p.empty(),i.setMap(null);else{var a=Publish.data[t],s=a[0],l=a[1];e(l,s),i.setMap(d)}else{u.fadeIn();var m=Publish.path+t+".geojson";$.getJSON(m,function(n){var i=Publish.data[t],a=i[0],s=i[1],l=new google.maps.Data;l.addGeoJson(n),l.forEach(function(e){e.setProperty("color",s[e.getProperty(a)])}),l.setStyle(o),l.setMap(d),r[t]=l,e(s,a)}).always(function(){u.fadeOut()})}}function t(e){var o=[],n=new google.maps.LatLngBounds;$.each(e,function(e){var t=Publish.path+e+".geojson";o.push($.getJSON(t,function(e){var o=new google.maps.Data;o.addGeoJson(e),o.forEach(function(e){e.getGeometry().forEachLatLng(function(e){n.extend(e)})})}))}),setTimeout(function(){$.when(o).then(function(){d.fitBounds(n)})},1e3)}function i(){google.maps.visualRefresh=!0;var e={minZoom:Publish.minZoom,maxZoom:Publish.maxZoom,mapTypeId:google.maps.MapTypeId[Publish.mapTypeId],mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU,position:google.maps.ControlPosition.TOP_RIGHT}};Publish.center&&(e.center=new google.maps.LatLng(Publish.center.lat,Publish.center.long)),Publish.zoom&&(e.zoom=Publish.zoom);var o=document.getElementById("map");d=new google.maps.Map(o,e),d.controls[google.maps.ControlPosition.LEFT_BOTTOM].push(p[0]),d.controls[google.maps.ControlPosition.BOTTOM_RIGHT].push($("#footer")[0]),$("#layers").find(":button").click(n),Publish.zoom||t(Publish.data)}function a(){var e=$(".mini-submenu-left");e.is(":visible")?$("#map").find(".ol-zoom").css("margin-left",0).removeClass("zoom-top-opened-sidebar").addClass("zoom-top-collapsed"):$("#map").find(".ol-zoom").css("margin-left",$(".sidebar-left").width()).removeClass("zoom-top-opened-sidebar").removeClass("zoom-top-collapsed")}function s(){return $(".sidebar").width()==$(window).width()}function l(){s()&&($(".sidebar-left .sidebar-body").fadeOut("slide"),$(".mini-submenu-left").fadeIn())}var d,r={},p=$("#legend"),u=$("#loader");google.maps.event.addDomListener(window,"load",i),$(".sidebar-left .slide-submenu").on("click",function(){var e=$(this);e.closest(".sidebar-body").fadeOut("slide",function(){$(".mini-submenu-left").fadeIn(),a()})}),$(".mini-submenu-left").on("click",function(){var e=$(this);$(".sidebar-left .sidebar-body").toggle("slide"),e.hide(),a()}),$(window).on("resize",a),l(),a()});